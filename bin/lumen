#!/bin/sh

DIR=`pwd`
cd "`dirname $0`"
HOME=`pwd`
cd $DIR

HOST=${LUMEN_HOST:-lua}

case $HOST in
    node*) CODE=lumen.js;;
    *) CODE=lumen.lua;;
esac

COMPILING=0

for v in "$@"
do
    if [ "$v" = "-c" ]
    then
        COMPILING=1
    fi
done

ARGS=""

if [ $COMPILING -ne 1 ] && [ -r .lumenrc ]
then
    ARGS=`cat .lumenrc`
fi

exec $HOST $HOME/$CODE $ARGS "$@"
